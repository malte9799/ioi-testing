name: Build and Create Prerelease
on:
  workflow_dispatch:
#   push:
#     branches: [main, master]

permissions:
  contents: write

jobs:
  build_and_prerelease:
    name: Build and Create/Update Prerelease
    runs-on: windows-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      #   - name: Install 7-Zip
      #     run: |
      #       choco install 7zip -y
      #     shell: pwsh

      - name: Run export script
        shell: cmd
        working-directory: ./helper/export
        run: run.bat

      - name: Create or Update Prerelease
        uses: softprops/action-gh-release@v2
        with:
          tag_name: prerelease
          name: Prerelease (Automatisch generiert)
          body: |
            Dies ist ein automatisch generierter Prerelease.
            Enth√§lt den neuesten Build aus dem '${{ github.ref_name }}'-Branch.
            Artefakt: ioi-testing.zip
          draft: false
          prerelease: true
          files: ./helper/export/ioi-testing.zip
